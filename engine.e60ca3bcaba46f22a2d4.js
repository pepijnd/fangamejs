(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{11:function(t,i,e){"use strict";e.d(i,"a",function(){return r});var s=e(0),o=e.n(s),n=e(1),h=e.n(n),r=function(){function i(t){o()(this,i),this.x=t.x,this.y=t.y}return h()(i,[{key:"checkCollision",value:function(t){throw new Error("use of base hitbox")}},{key:"getVertices",value:function(){return[]}},{key:"toAABB",value:function(){throw new Error("use of base hitbox")}},{key:"toPolygon",value:function(){throw new Error("use of base hitbox")}},{key:"update",value:function(){}}],[{key:"Create",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return t.push(this.GetDefaultOptions()),new this.prototype.constructor(t)}},{key:"GetDefaultOptions",value:function(){return{x:0,y:0}}}]),i}()},19:function(t,i,e){"use strict";e.d(i,"a",function(){return r});var s=e(0),o=e.n(s),n=e(1),h=e.n(n),r=function(){function e(t,i){o()(this,e),this.canvas=t,this.settings=i,this.controller=null,this.ctx=null,this.width=null,this.height=null,this.viewport=[{x:0,y:0,w:this.width,h:this.height}],this.vpi=0}return h()(e,[{key:"init",value:function(){this.ctx=this.canvas.getContext("2d"),this.width=this.canvas.width,this.height=this.canvas.height}},{key:"setViewportContext",value:function(){!1!==this.vpi&&(this.ctx.scale(this.width/this.viewport[this.vpi].w,this.height/this.viewport[this.vpi].h),this.ctx.translate(-this.viewport[this.vpi].x,-this.viewport[this.vpi].y))}},{key:"setController",value:function(t){this.controller=t}},{key:"drawSprite",value:function(t,i,e){var s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;this.ctx.save(),this.setViewportContext(),this.ctx.translate(i,e),this.ctx.scale(t.scale.x,t.scale.y),this.ctx.drawImage(t.img,t.offsetX+t.sprite_positions[s][0]*(t.spacingX+t.sprite_width),t.offsetY+t.sprite_positions[s][1]*(t.spacingY+t.sprite_height),t.sprite_width,t.sprite_height,-t.offset.x*t.ratio.x,-t.offset.y*t.ratio.y,t.width,t.height),this.ctx.restore()}},{key:"drawSpriteRot",value:function(t,i,e,s){var o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0;this.ctx.save(),this.setViewportContext(),this.ctx.translate(i,e),this.ctx.rotate(s),this.ctx.scale(t.scale.x,t.scale.y),this.ctx.drawImage(t.img,t.offsetX+t.sprite_positions[o][0]*(t.spacingX+t.sprite_width),t.offsetY+t.sprite_positions[o][1]*(t.spacingY+t.sprite_height),t.sprite_width,t.sprite_height,-t.offset.x*t.ratio.x,-t.offset.y*t.ratio.y,t.width,t.height),this.ctx.restore()}},{key:"drawClear",value:function(){this.ctx.fillStyle="#ffffff",this.ctx.fillRect(0,0,this.width,this.height)}},{key:"drawText",value:function(t,i,e){var s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:30,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"arial",n=5<arguments.length?arguments[5]:void 0;this.ctx.save(),this.setViewportContext(),this.ctx.font=s+"px "+o,this.ctx.fillStyle="#000000",this.ctx.fillText(t,i,e,n),this.ctx.restore()}},{key:"drawLine",value:function(t,i,e,s){var o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"#000000";this.ctx.save(),this.setViewportContext(),this.ctx.fillStyle=o,this.ctx.beginPath(),this.ctx.moveTo(t,i),this.ctx.lineTo(e,s),this.ctx.stroke(),this.ctx.restore()}},{key:"drawRect",value:function(t,i,e,s){var o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"#000000";this.ctx.save(),this.setViewportContext(),this.ctx.fillStyle=o,this.ctx.fillRect(t,i,e,s),this.ctx.restore()}},{key:"drawRectRot",value:function(t,i,e,s,o){var n=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"#000000";this.ctx.save(),this.setViewportContext(),this.ctx.translate(t+e/2,i+s/2),this.ctx.rotate(o),this.ctx.fillStyle=n,this.ctx.fillRect(-e/2,-s/2,e,s),this.ctx.restore()}},{key:"drawVector",value:function(t,i,e){3<arguments.length&&void 0!==arguments[3]&&arguments[3];this.ctx.save(),this.setViewportContext(),this.ctx.translate(t,i),this.drawLine(0,0,e.m*Math.cos(e.a),e.m*Math.sin(e.a)),this.ctx.restore()}},{key:"drawPolygon",value:function(t,i,e){var s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"#000000";this.ctx.save(),this.setViewportContext(),this.ctx.beginPath(),this.ctx.translate(t,i);var o=e[0];this.ctx.moveTo(o.x,o.y);for(var n=1;n<e.length;n++){var h=e[n];this.ctx.lineTo(h.x,h.y)}this.ctx.closePath(),this.ctx.strokeStyle=s,this.ctx.stroke(),this.ctx.restore()}}]),e}()},24:function(t,i,e){"use strict";var s=e(0),c=e.n(s),o=e(1),n=e.n(o),h=e(3),r=e.n(h),l=e(2),a=e.n(l),u=e(4),p=e.n(u),v=e(5),f=function(){function a(t,i,e,s,o,n,h,r,l){c()(this,a),this.img=t,this.sprite_width=i,this.sprite_height=e,this.sprite_positions=s,this.offsetX=o,this.offsetY=n,this.spacingX=h,this.spacingY=r,this.scale=l,this.offset={x:0,y:0},this.ratio={x:1,y:1}}return n()(a,[{key:"center",value:function(){this.offset.x=this.sprite_width/2,this.offset.y=this.sprite_height/2}},{key:"width",get:function(){return this.sprite_width*this.ratio.x}},{key:"height",get:function(){return this.sprite_height*this.ratio.y}}],[{key:"fromImage",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,n=5<arguments.length&&void 0!==arguments[5]?arguments[5]:{x:1,y:1};return new a(t,i||t.width,e||t.height,[[0,0]],s,o,0,0,n)}},{key:"fromSpritesheet",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[[0,0]],o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,n=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,h=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,r=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,l=8<arguments.length&&void 0!==arguments[8]?arguments[8]:{x:1,y:1};return new a(t,i||t.width,e||t.height,s,o,n,h,r,l)}}]),a}(),d=e(9),y=e.n(d),x=e(8),g=e(13),k=e.n(g),w=e(7),b=e(16),m=e.n(b),C=e(6),M=function(t){function i(){return c()(this,i),r()(this,a()(i).apply(this,arguments))}return p()(i,t),n()(i,[{key:"evtCreate",value:function(){this.sprite=f.fromImage(this.controller.imageController.getImage(m.a)),this.hitbox=C.a.Create(),this.hitbox.w=this.sprite.width,this.hitbox.h=this.sprite.height,this.hitbox.x=this.position.x,this.hitbox.y=this.position.y,this.hitbox.update(),this.controller.registerHitbox("platform",this),this.controller.registerHitbox("block",this)}},{key:"evtStep",value:function(){}},{key:"evtDraw",value:function(t){t.drawSprite(this.sprite,this.position.x,this.position.y)}}]),i}(v.a),_=e(14),j=e.n(_),S=function(t){function i(){return c()(this,i),r()(this,a()(i).apply(this,arguments))}return p()(i,t),n()(i,[{key:"evtCreate",value:function(){this.sprite=f.fromImage(this.controller.imageController.getImage(j.a)),this.hitbox=C.a.Create(),this.hitbox.w=this.sprite.width,this.hitbox.h=this.sprite.height,this.hitbox.x=this.position.x,this.hitbox.y=this.position.y,this.hitbox.update(),this.controller.registerHitbox("solid",this),this.controller.registerHitbox("blood",this)}},{key:"evtStep",value:function(){}},{key:"evtDraw",value:function(t){t.drawSprite(this.sprite,this.position.x,this.position.y)}}]),i}(v.a),P=function(t){function i(){return c()(this,i),r()(this,a()(i).apply(this,arguments))}return p()(i,t),n()(i,[{key:"evtCreate",value:function(){this.offset={x:1,y:1},this.hitbox=C.a.Create({w:2,h:2,x:this.position.x+this.offset.x,y:this.position.y+this.offset.y}),this.hitbox.update(),this.collision=!1,this.hspeed=8*(Math.random()-.5),this.vspeed=8*(Math.random()-.8),this.counter=0,this.gravity=.44,this.controller.registerHitbox("blood",this),this.controller.registerCollision("blood",this,S)}},{key:"evtCollision",value:function(t,i){this.collision=!0,this.controller.deleteHitbox("blood",this),this.controller.deleteCollision("blood",this)}},{key:"evtStep",value:function(){this.collision||(this.vspeed+=this.gravity,this.hspeed*=.98,this.vspeed*=.98,this.position.x+=this.hspeed,this.position.y+=this.vspeed),200<this.counter?this.delete():this.counter+=1}},{key:"evtEndStep",value:function(){this.hitbox.x=this.position.x+this.offset.x,this.hitbox.y=this.position.y+this.offset.y,this.hitbox.update()}},{key:"evtDraw",value:function(t){t.drawRect(this.position.x-1,this.position.y-1,2,2,"#ff0000")}}]),i}(v.a),O=function(t){function i(){return c()(this,i),r()(this,a()(i).apply(this,arguments))}return p()(i,t),n()(i,[{key:"evtCreate",value:function(){this.sprite=f.fromSpritesheet(this.controller.imageController.getImage(k.a),24,24,[[0,0],[1,0],[2,0],[3,0]],0,0),this.position.x=100,this.position.y=407,this.offset={x:8,y:3},this.hitbox=C.a.Create({w:11,h:21,x:this.position.x,y:this.position.y}),this.hitbox.update(),this.depth=-50,this.jump=8.5,this.jump2=7,this.djump=!0,this.jumpRelease=.45,this.gravity=.44,this.maxSpeed=3,this.maxVSpeed=9,this.vspeed=0,this.hspeed=0,this.platform=!1,this.controller.registerHitbox(0,this),this.controller.registerCollision(0,this,I),this.controller.registerHitbox("platform",this),this.controller.registerCollision("platform",this,M)}},{key:"evtBeginStep",value:function(){this.hspeed=0,this.platform=!1}},{key:"evtCollision",value:function(t,i){this.collision=!0,"platform"===i.layer&&this.position.y-this.vspeed/2+this.sprite.height/2<=t.position.y&&(this.position.y=t.position.y-this.sprite.height-1,void 0!==t.vspeed&&0<=t.vspeed?this.vspeed=t.vspeed:this.vspeed=0,this.djump=!0,this.platform=!0)}},{key:"evtStep",value:function(){if(this.controller.inputController.checkDown(w.arrow.left)&&(this.hspeed=-3,this.sprite.scale.x=-1),this.controller.inputController.checkDown(w.arrow.right)&&(this.hspeed=3,this.sprite.scale.x=1),this.controller.inputController.checkDown(w.space)&&(this.collision=!1),this.controller.inputController.checkPressed(82))for(var t=0;t<20;t++){var i=P.Create(this.controller);i.position.x=this.position.x+this.offset.x,i.position.y=this.position.y+this.offset.y}this.vspeed+=this.gravity,this.placeFree("solid",this.position.x,this.position.y+1)&&this.vspeed>this.maxVSpeed&&(this.vspeed=this.maxVSpeed),this.controller.inputController.checkPressed(w.shift)&&!this.placeFree("solid",this.position.x,this.position.y+1)?(this.vspeed=-this.jump,this.djump=!0):this.controller.inputController.checkPressed(w.shift)&&this.djump?(this.vspeed=-this.jump2,this.djump=!1):this.controller.inputController.checkReleased(w.shift)&&this.vspeed<0&&(this.vspeed*=this.jumpRelease),this.placeFree("solid",this.position.x+this.hspeed,this.position.y)||(this.hspeed<=0?this.moveContact("solid",Math.PI,Math.abs(this.hspeed)):0<this.hspeed&&this.moveContact("solid",0,Math.abs(this.hspeed)),this.hspeed=0),this.placeFree("solid",this.position.x,this.position.y+this.vspeed)||(this.vspeed<=0?this.moveContact("solid",1.5*Math.PI,Math.abs(this.vspeed)):0<this.vspeed&&(this.moveContact("solid",.5*Math.PI,Math.abs(this.vspeed)),this.djump=!0),this.vspeed=0),this.placeFree("platform",this.position.x,this.position.y+this.vspeed)||0<this.vspeed&&(this.moveContact("platform",.5*Math.PI,Math.abs(this.vspeed)),this.vspeed=0),this.placeFree("solid",this.position.x+this.hspeed,this.position.y+this.vspeed)||(this.hspeed=0)}},{key:"evtEndStep",value:function(){this.position.x+=this.hspeed,this.position.y+=this.vspeed,this.hitbox.x=this.position.x,this.hitbox.y=this.position.y,this.hitbox.update()}},{key:"evtDraw",value:function(t){this.sprite.scale.x<0?t.drawSprite(this.sprite,this.position.x+this.sprite.width-5,this.position.y-this.offset.y):t.drawSprite(this.sprite,this.position.x-this.offset.x,this.position.y-this.offset.y)}}]),i}(v.a),I=function(t){function i(){return c()(this,i),r()(this,a()(i).apply(this,arguments))}return p()(i,t),n()(i,[{key:"evtCreate",value:function(){this.sprites={up:f.fromSpritesheet(this.controller.imageController.getImage(y.a),32,32,[[0,0]],0,0),down:f.fromSpritesheet(this.controller.imageController.getImage(y.a),32,32,[[1,0]],0,0),left:f.fromSpritesheet(this.controller.imageController.getImage(y.a),32,32,[[2,0]],0,0),right:f.fromSpritesheet(this.controller.imageController.getImage(y.a),32,32,[[3,0]],0,0)},this.hitboxes={up:x.a.Create({vertices:[{x:0,y:32},{x:32,y:32},{x:16,y:0}]}),down:x.a.Create({vertices:[{x:0,y:0},{x:32,y:0},{x:16,y:32}]}),left:x.a.Create({vertices:[{x:32,y:32},{x:0,y:16},{x:32,y:0}]}),right:x.a.Create({vertices:[{x:0,y:0},{x:32,y:16},{x:0,y:32}]})},void 0===this.direction&&(this.direction="up"),this.sprite=this.sprites[this.direction],this.hitbox=this.hitboxes[this.direction],this.hitbox.x=this.position.x,this.hitbox.y=this.position.y,this.hitbox.update(),this.controller.registerHitbox(0,this),this.controller.registerCollision(0,this,O),this.collision=!1}},{key:"evtBeginStep",value:function(){this.collision=!1}},{key:"evtCollision",value:function(t,i){this.collision=!0}},{key:"evtStep",value:function(){}},{key:"evtDraw",value:function(t){t.drawSprite(this.sprite,this.position.x,this.position.y),this.collision&&t.drawRect(this.position.x+2,this.position.y+28,28,4,"#ff0000")}}]),i}(v.a),A=e(15),B=e.n(A),E=(e(18),e(10)),D=e.n(E),V=function(t){function e(t){var i;return c()(this,e),(i=r()(this,a()(e).call(this,t))).r=t.r,i.res=t.res,i.aabb=C.a.Create(),i}return p()(e,t),n()(e,[{key:"update",value:function(){this.r;this.aabb.w=2*this.r,this.aabb.h=2*this.r,this.aabb.x=this.x,this.aabb.y=this.y}},{key:"checkCollision",value:function(t){return!!this.toAABB().checkCollision(t.toAABB())&&this.toPolygon().checkCollision(t.toPolygon())}},{key:"rotateVertice",value:function(t){var i=Math.sin(this.r),e=Math.cos(this.r),s=t.x,o=t.y;return{x:s*e-o*i,y:s*i+o*e}}},{key:"getVertices",value:function(){for(var t=[],i=0;i<this.res;i++){var e=2*Math.PI/this.res*i;t.push({x:Math.cos(e)*this.r+this.r,y:Math.sin(e)*this.r+this.r})}return t}},{key:"toAABB",value:function(){return this.aabb}},{key:"toPolygon",value:function(){var t=x.a.Create({vertices:this.getVertices(),x:this.x,y:this.y});return t.update(),t}}],[{key:"Create",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return t=Object.assign({},this.GetDefaultOptions(),t),new this.prototype.constructor(t)}},{key:"GetDefaultOptions",value:function(){return Object.assign({},D()(a()(e),"GetDefaultOptions",this).call(this),{r:1,res:12})}}]),e}(e(11).a),R=function(t){function i(){return c()(this,i),r()(this,a()(i).apply(this,arguments))}return p()(i,t),n()(i,[{key:"evtCreate",value:function(){this.sprite=f.fromImage(this.controller.imageController.getImage(B.a)),this.hitbox=V.Create({r:5*this.sprite.width,x:this.position.x,y:this.position.y,res:64}),this.controller.registerHitbox("solid",this)}},{key:"evtStep",value:function(){}},{key:"evtEndStep",value:function(){this.hitbox.x=this.position.x,this.hitbox.y=this.position.y,this.hitbox.update()}},{key:"evtDraw",value:function(t){t.drawPolygon(this.position.x,this.position.y,this.hitbox.getVertices(),"#ff0000")}}]),i}(v.a);e.d(i,"a",function(){return F});var F=function(t){function i(){return c()(this,i),r()(this,a()(i).apply(this,arguments))}return p()(i,t),n()(i,[{key:"evtCreate",value:function(){O.Create(this.controller),this.depth=-100,this.grid=!1,this.gridSize=32;for(var t=1;t<this.controller.context.width/32-1;t++){var i=S.Create(this.controller);i.position.x=32*t,i.position.y=this.controller.context.height-32;var e=S.Create(this.controller);e.position.x=32*t,e.position.y=0}for(var s=0;s<this.controller.context.height/32;s++){var o=S.Create(this.controller);o.position.x=0,o.position.y=32*s;var n=S.Create(this.controller);n.position.x=this.controller.context.width-32,n.position.y=32*s}}},{key:"evtStep",value:function(){var t=Math.floor(this.controller.inputController.mouse.x/this.gridSize)*this.gridSize,i=Math.floor(this.controller.inputController.mouse.y/this.gridSize)*this.gridSize;if(this.controller.inputController.mouse.click){var e=S.Create(this.controller);e.position.x=t,e.position.y=i}if(this.controller.inputController.checkReleased(w.s)){var s=I.Create(this.controller);s.position.x=t,s.position.y=i}if(this.controller.inputController.checkReleased(w.b)){var o=R.Create(this.controller);o.position.x=t,o.position.y=i}if(this.controller.inputController.checkReleased(w.p)){var n=M.Create(this.controller);n.position.x=t,n.position.y=i}if(this.controller.inputController.checkReleased(w.backspace)){var h=null,r=-1,l=t,a=i;this.controller.objectController.forAll(function(t){var i=Math.sqrt(Math.pow(l-t.position.x,2)+Math.pow(a-t.position.y,2));(-1===r||i<r)&&(h=t,r=i)}),r<this.gridSize&&h.delete()}this.controller.inputController.checkPressed(w.zero)&&(this.grid=!this.grid),this.controller.inputController.checkPressed(w.minus)&&(this.gridSize/=2),this.controller.inputController.checkPressed(w.plus)&&(this.gridSize*=2)}},{key:"evtDraw",value:function(t){if(this.grid){for(var i=this.gridSize;i<t.width;i+=this.gridSize)t.drawLine(i,0,i,t.height,"#000000");for(var e=this.gridSize;e<t.height;e+=this.gridSize)t.drawLine(0,e,t.width,e,"#000000")}}}]),i}(v.a)},25:function(t,i,e){"use strict";var s=e(0),o=e.n(s),n=e(1),h=e.n(n),r=function(){function i(t){o()(this,i),this.controller=t,this.imageList={},this.promises=[]}return h()(i,[{key:"getImage",value:function(t){return this.imageList[t]}},{key:"register",value:function(e){var s=this,o=new Image;this.promises.push(new Promise(function(t,i){o.addEventListener("load",function(){t(o.src)},!1),o.src=e,s.imageList[e]=o}))}}]),i}(),l=e(12),a=e.n(l),c=function(){function t(e){var s=this;o()(this,t),this.controller=e,this.keysPressed=[],this.keysReleased=[],this.newKeys=[],this.keys=[],this.mouse={x:0,y:0,click:!1},this.newMouse={x:0,y:0,click:!1},a()(document).on("keydown",function(t){var i=t.which;-1===s.newKeys.indexOf(i)&&s.newKeys.push(i),t.preventDefault()}),a()(document).on("keyup",function(t){var i=t.which;s.newKeys=s.newKeys.filter(function(t){return t!==i}),t.preventDefault()}),a()(document).on("mousemove",function(t){var i=e.context.canvas.getBoundingClientRect();s.newMouse.x=t.pageX-i.left,s.newMouse.y=t.pageY-i.top}),a()(document).on("click",function(t){s.newMouse.click=!0})}return h()(t,[{key:"setInputs",value:function(){var i=this;this.keysPressed=this.newKeys.filter(function(t){return-1===i.keys.indexOf(t)}),this.keysReleased=this.keys.filter(function(t){return-1===i.newKeys.indexOf(t)}),this.keys=this.newKeys.slice(),this.mouse=Object.assign({},this.newMouse),this.newMouse.click=!1}},{key:"checkDown",value:function(t){return-1!==this.keys.indexOf(t)}},{key:"checkPressed",value:function(t){return-1!==this.keysPressed.indexOf(t)}},{key:"checkReleased",value:function(t){return-1!==this.keysReleased.indexOf(t)}}]),t}(),u=function(){function i(t){o()(this,i),this.controller=t,this.objects={},this.next_id=3}return h()(i,[{key:"register",value:function(t){t.id=this.next_id,this.objects[this.next_id]=t,this.next_id+=1,t._controller=this.controller,this.controller.newObjects.push(t)}},{key:"forAll",value:function(t){var i=this,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"id",s=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if("depth"===e){var o=Object.keys(this.objects).map(function(t){return[i.objects[t].depth,i.objects[t]]});o=o.sort(function(t,i){return i[0]-t[0]});for(var n=0;n<o.length;n++)s&&!o[n][1].created||t(o[n][1])}else for(var h in this.objects)this.objects.hasOwnProperty(h)&&(s&&!this.objects[h].created||t(this.objects[h]))}}]),i}(),p=e(6);e.d(i,"a",function(){return v});var v=function(){function i(t){o()(this,i),this.context=t,this.context.setController(this),this.imageController=new r(this),this.inputController=new c(this),this.objectController=new u(this),this.collisionMap={},this.collisionMapEvents={},this.newObjects=[],this.drawInterval=null,this.tickInterval=null,this.frames=0,this.ticks=0,this.realFps=0,this.realTicks=0,this.frametime=0}return h()(i,[{key:"run",value:function(e){var s=this;Promise.all(this.imageController.promises).then(function(){s.context.init(),s.setLoops();var t=0,i=0;setInterval(function(){s.realFps=s.frames-t,t=s.frames,s.realTicks=s.ticks-i,i=s.ticks},1e3),e()}).catch(function(t){console.log(t)})}},{key:"setLoops",value:function(){var t=this;window.cancelAnimationFrame(this.drawInterval),clearInterval(this.tickInterval);var i=this;this.drawInterval=window.requestAnimationFrame(function t(){i.drawLoop(),i.drawInterval=window.requestAnimationFrame(t)}),this.tickInterval=setInterval(function(){t.tickLoop()},1e3/this.context.settings.tickrate)}},{key:"drawLoop",value:function(){var i=this;this.context.drawClear(),this.objectController.forAll(function(t){t.evtDraw(i.context)},"depth"),this.frames+=1}},{key:"col_check_point",value:function(t,i,e){var s=3<arguments.length&&void 0!==arguments[3]&&arguments[3],o=s?Object.assign(Object.create(Object.getPrototypeOf(s)),s):p.a.Create({x:i,y:e,w:1,h:1});if(o.x=i,o.y=e,o.update(),t in this.collisionMap)for(var n=0;n<this.collisionMap[t].length;n++){var h=this.collisionMap[t][n];if(!1!==h.hitbox){if(h.hitbox.checkCollision(o))return h}else if(h.obj.hitbox.checkCollision(o))return h}return!1}},{key:"hitboxCheckCollision",value:function(t,i){if(t in this.collisionMap)for(var e=0;e<this.collisionMap[t].length;e++){var s=this.collisionMap[t][e];if(!1!==s.hitbox){if(s.hitbox.checkCollision(i))return s}else if(s.obj.hitbox.checkCollision(i))return s}return!1}},{key:"tickLoop",value:function(){var t=window.performance.now();this.inputController.setInputs();var i=this.newObjects.slice();this.newObjects=[];for(var e=0;e<i.length;e++)i[e].evtCreate(),i[e]._created=!0;for(var s in this.objectController.forAll(function(t){t.evtBeginStep()}),this.collisionMap)if(this.collisionMap.hasOwnProperty(s))for(var o=this.collisionMap[s],n=0;n<o.length;n++)for(var h=0;h<o.length;h++)if(o[n]!==o[h]&&void 0!==this.collisionMapEvents[s]&&o[n].obj.id in this.collisionMapEvents[s])for(var r=this.collisionMapEvents[s][o[n].obj.id],l=0;l<r.length;l++)if(!0===r[l]||o[h].obj instanceof r[l]){var a=o[n].hitbox?o[n].hitbox:o[n].obj.hitbox,c=o[h].hitbox?o[h].hitbox:o[h].obj.hitbox;a.checkCollision(c)&&o[n].obj.evtCollision(o[h].obj,{layer:s,self:a,other:c})}this.objectController.forAll(function(t){t.evtStep()}),this.objectController.forAll(function(t){t.evtEndStep()}),this.ticks+=1,this.frametime=Math.round(100*(window.performance.now()-t))/100,this.ticks%50==0&&(document.getElementById("geFps").value="Fps: "+this.realFps,document.getElementById("geTickrate").value="Tickrate: "+this.realTicks,document.getElementById("geFrametime").value="Frametime: "+this.frametime)}},{key:"registerHitbox",value:function(t,i){var e=2<arguments.length&&void 0!==arguments[2]&&arguments[2];t in this.collisionMap||(this.collisionMap[t]=[]),this.collisionMap[t].push({obj:i,hitbox:e})}},{key:"deleteHitbox",value:function(t,i){var e=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(!0===t)for(var s in this.collisionMap)this.collisionMap.hasOwnProperty(s)&&this.deleteHitbox(s,i,e);else{if(!(t in this.collisionMap))throw Error();this.collisionMap[t]=this.collisionMap[t].filter(function(t){return!(t.obj===i&&(!e||i.hitbox===e))})}}},{key:"registerCollision",value:function(t,i,e){t in this.collisionMapEvents||(this.collisionMapEvents[t]={}),i.id in this.collisionMapEvents[t]||(this.collisionMapEvents[t][i.id]=[]),this.collisionMapEvents[t][i.id].push(e)}},{key:"deleteCollision",value:function(t,i){var e=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(!0===t)for(var s in this.collisionMapEvents)this.collisionMapEvents.hasOwnProperty(s)&&this.deleteCollision(s,i,e);else{if(!(t in this.collisionMapEvents))throw Error();if(e){var o=this.collisionMapEvents[t][i.id].indexOf(e);-1!==o&&this.collisionMapEvents[t][i.id].slice(o,1)}else i.id in this.collisionMapEvents[t]&&delete this.collisionMapEvents[t][i.id]}}},{key:"fps",get:function(){return this.realFps},set:function(t){this.context.settings.fps=t,this.setLoops()}},{key:"tickrate",get:function(){return this.realTicks},set:function(t){this.context.settings.tickrate=t,this.setLoops()}}]),i}()},32:function(t,i,e){"use strict";var s=e(5);s.a.prototype.placeFree=function(t,i,e){var s=3<arguments.length&&void 0!==arguments[3]&&arguments[3]||Object.assign(Object.create(Object.getPrototypeOf(this.hitbox)),this.hitbox);return s.x=i,s.y=e,s.update(),!this.controller.hitboxCheckCollision(t,s)},s.a.prototype.moveContact=function(t,i,e,s){for(var o=0,n=Math.cos(i),h=Math.sin(i);Math.pow(n*o,2)+Math.pow(h*o,2)<Math.pow(e,2)&&this.placeFree(t,this.position.x+n*(o+1),this.position.y+h*(o+1),s);)o++;this.position.x+=n*o,this.position.y+=h*o}},5:function(t,i,e){"use strict";e.d(i,"a",function(){return l});var s=e(0),o=e.n(s),n=e(1),h=e.n(n),r=e(6),l=function(){function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;o()(this,i),this._id=null,this._created=!1,this._deleted=!1,this._controller=null,this.sprite=t,this.sprite_index=0,this.sprite_speed=1,this.depth=0,this.position={x:0,y:0},this.hitbox=null}return h()(i,[{key:"evtCreate",value:function(){this.hitbox=null!==this.sprite?r.a.Create({w:this.sprite.width,h:this.sprite.height}):null}},{key:"evtBeginStep",value:function(){}},{key:"evtStep",value:function(){if(null!==this.sprite){var t=this.sprite.sprite_positions.length;this.sprite_index=Math.floor(this.controller.ticks*this.sprite_speed)%t}null!==this.hitbox&&(this.hitbox.x=this.position.x,this.hitbox.y=this.position.y,null!==this.sprite&&(this.hitbox.x-=this.sprite.offset.x*this.sprite.ratio.x,this.hitbox.y-=this.sprite.offset.y*this.sprite.ratio.y))}},{key:"evtEndStep",value:function(){}},{key:"evtDraw",value:function(t){this.vpi=0,null!==this.sprite&&t.drawSprite(this.sprite,this.position.x,this.position.y,this.sprite_index)}},{key:"evtCollision",value:function(t){}},{key:"delete",value:function(){this.controller.deleteHitbox(!0,this),this.controller.deleteCollision(!0,this),delete this.controller.objectController.objects[this.id]}},{key:"id",get:function(){return this._id},set:function(t){this._id=t}},{key:"created",get:function(){return this._created}},{key:"controller",get:function(){return this._controller}},{key:"deleted",get:function(){return this._deleted}}],[{key:"Create",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=new this.prototype.constructor(i);return t.objectController.register(e),e}}]),i}()},6:function(t,i,e){"use strict";e.d(i,"a",function(){return x});var s=e(0),o=e.n(s),n=e(1),h=e.n(n),r=e(3),l=e.n(r),a=e(2),c=e.n(a),u=e(10),p=e.n(u),v=e(4),f=e.n(v),d=e(11),y=e(8),x=function(t){function e(t){var i;return o()(this,e),(i=l()(this,c()(e).call(this,t))).w=t.w,i.h=t.h,i}return f()(e,t),h()(e,[{key:"checkAABBCollision",value:function(t){return this.x<t.x+t.w&&this.x+this.w>t.x&&this.y<t.y+t.h&&this.y+this.h>t.y}},{key:"checkCollision",value:function(t){return t.constructor===e?this.checkAABBCollision(t):!!this.checkAABBCollision(t.toAABB())&&this.toPolygon().checkCollision(t.toPolygon())}},{key:"getVertices",value:function(){var t=[];return t.push({x:0,y:0}),t.push({x:this.w,y:0}),t.push({x:this.w,y:this.h}),t.push({x:0,y:this.h}),t}},{key:"toAABB",value:function(){return this}},{key:"toPolygon",value:function(){var t=y.a.Create({vertices:this.getVertices()});return(t=Object.assign(t,this)).update(),t}}],[{key:"Create",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return t=Object.assign({},this.GetDefaultOptions(),t),new this.prototype.constructor(t)}},{key:"GetDefaultOptions",value:function(){return Object.assign({},p()(c()(e),"GetDefaultOptions",this).call(this),{w:0,h:0})}}]),e}(d.a)},8:function(t,i,e){"use strict";var s=e(0),o=e.n(s),n=e(1),h=e.n(n),r=e(3),l=e.n(r),a=e(2),c=e.n(a),u=e(10),p=e.n(u),v=e(4),f=e.n(v),d=e(11),y=e(6),g=function(){function e(t,i){o()(this,e),this.a=t,this.m=i}return h()(e,[{key:"unitVector",value:function(){return{x:Math.cos(this.a),y:Math.sin(this.a)}}},{key:"dotProduct",value:function(t){return this.m*t.m*Math.cos(this.a-t.a)}}],[{key:"fromPoints",value:function(t,i,e,s){return this.fromPoint(i-t,s-e)}},{key:"fromPoint",value:function(t,i){return new e(Math.atan2(i,t),Math.sqrt(t*t+i*i))}}]),e}();e.d(i,"a",function(){return x});var x=function(t){function e(t){var i;return o()(this,e),(i=l()(this,c()(e).call(this,t))).r=t.r,i.vertices=t.vertices,i.aabb=y.a.Create(),i}return f()(e,t),h()(e,[{key:"getsize",value:function(){for(var t=null,i=null,e=null,s=null,o=0;o<this.vertices.length;o++)(null===t||this.vertices[o].x<t)&&(t=this.vertices[o].x),(null===i||this.vertices[o].y<i)&&(i=this.vertices[o].y),(null===e||this.vertices[o].x>e)&&(e=this.vertices[o].x),(null===s||this.vertices[o].y>s)&&(s=this.vertices[o].y);return{w:e-t,h:s-i}}},{key:"update",value:function(){var t=this.getsize(),i=t.w,e=t.h,s=this.r;this.r<Math.PI/2||this.r>Math.PI&&this.r<3*Math.PI/2||(i=t.h,e=t.w,s=this.r-Math.PI/2),this.aabb.w=Math.abs(i*Math.cos(s)+e*Math.sin(s)),this.aabb.h=Math.abs(i*Math.sin(s)+e*Math.cos(s)),this.aabb.x=this.x,this.aabb.y=this.y}},{key:"checkPolygonCollision",value:function(t){for(var i=this.getVertices(),e=t.getVertices(),s=[],o=0;o<i.length;o++){var n=i[o],h=i[o+1===i.length?0:o+1];s.push(new g(Math.atan2(h.y-n.y,h.x-n.x)+Math.PI/2,1))}for(var r=0;r<e.length;r++){var l=e[r],a=e[r+1===e.length?0:r+1];s.push(new g(Math.atan2(a.y-l.y,a.x-l.x)+Math.PI/2,1))}for(var c=[],u=0;u<s.length;u++){for(var p={p1_min:null,p1_max:null,p2_min:null,p2_max:null},v=0;v<i.length;v++){var f=g.fromPoint(i[v].x+this.x,i[v].y+this.y).dotProduct(s[u]);(null===p.p1_min||f<=p.p1_min)&&(p.p1_min=f),(null===p.p1_max||f>=p.p1_max)&&(p.p1_max=f)}for(var d=0;d<e.length;d++){var y=g.fromPoint(e[d].x+t.x,e[d].y+t.y).dotProduct(s[u]);(null===p.p2_min||y<=p.p2_min)&&(p.p2_min=y),(null===p.p2_max||y>=p.p2_max)&&(p.p2_max=y)}c.push(p)}for(var x=0;x<c.length;x++)if(c[x].p1_max<c[x].p2_min||c[x].p2_max<c[x].p1_min)return!1;return!0}},{key:"checkCollision",value:function(t){return!!this.toAABB().checkCollision(t.toAABB())&&(t.constructor===e?this.checkPolygonCollision(t):this.checkCollision(t.toPolygon()))}},{key:"toAABB",value:function(){return this.aabb}},{key:"toPolygon",value:function(){return this}},{key:"rotateVertice",value:function(t){var i=Math.sin(this.r),e=Math.cos(this.r),s=t.x,o=t.y;return{x:s*e-o*i,y:s*i+o*e}}},{key:"getVertices",value:function(){var i=this;return 0!==this.r?this.vertices.map(function(t){return i.rotateVertice(t)}):this.vertices.slice()}}],[{key:"Create",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return t=Object.assign({},this.GetDefaultOptions(),t),new this.prototype.constructor(t)}},{key:"GetDefaultOptions",value:function(){return Object.assign({},p()(c()(e),"GetDefaultOptions",this).call(this),{r:0,vertices:[{x:0,y:0},{x:0,y:1},{x:1,y:1},{x:1,y:0}]})}}]),e}(d.a)}}]);